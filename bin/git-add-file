#!/bin/bash
if [ "$1" != "" ] && [ "$1" != "-p" ]; then
    git add $@
else
    cd $(git rev-parse --show-toplevel)
    git ls-files . -m -o --exclude-standard |
        fzf --height=40% --prompt="git add: " -m --print0 --exit-0 |
        xargs -0 -r git add $@ --
fi

